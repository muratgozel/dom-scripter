!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Scripter=t()}(this,(function(){"use strict";function e(){this.beingInjected=[],this.timeout=1e4}return e.prototype.reCSSExt=/(.css)/g,e.prototype.supportedLocations=["bodyEnd","bodyStart","headEnd"],e.prototype.inject=function(e,t){var n=this;if(!t.id)throw new Error("Missing id for an injected script.");var i=n.reCSSExt.test(e),r=i?"link":"script";return new Promise((function(o,d){if(document.getElementById(t.id))return o(t.id);if(-1!==n.beingInjected.indexOf(t.id))return o(null);n.beingInjected.push(t.id);var a=setTimeout((function(){return d(new Error("TIMEOUT"))}),n.timeout),c=document.createElement(r);function s(){return i&&(c.media=t.media||"all"),clearTimeout(a),n.beingInjected=n.beingInjected.filter((function(e){return e!=t.id})),o(t.id)}c.id=t.id,"link"==r&&(c.rel="stylesheet",c.href=e,c.media="only x"),"script"==r&&(c.type=t.type||"text/javascript",c.async=!t.hasOwnProperty("async")||t.async),t.attrs&&Object.keys(t.attrs).map((function(e){return c.setAttribute(e,t.attrs[e])})),c.addEventListener?c.addEventListener("load",s,!1):c.readyState?c.onreadystatechange=s:c.onload&&(c.onload=s),c.onerror&&(c.onerror=function(e){return clearTimeout(a),n.beingInjected=n.beingInjected.filter((function(e){return e!=t.id})),d(e)}),"script"==r&&(c.src=e),n.injectToLocation(c,t.location)}))},e.prototype.injectJSONLD=function(e,t){if(t.id&&document.getElementById(t.id))return null;var n=document.createElement("script");n.type="application/ld+json",t.id&&(n.id=t.id),t.attrs&&Object.keys(t.attrs).map((function(e){return n.setAttribute(e,t.attrs[e])})),n.text="string"==typeof e?e:JSON.stringify(e),this.injectToLocation(n,t.location)},e.prototype.injectToLocation=function(e,t){var n=t||self.supportedLocations[0];if(-1!==self.supportedLocations.indexOf(n)){var i=document.getElementsByTagName("head")[0],r=document.getElementsByTagName("body")[0];"headEnd"==n?i.lastChild.parentNode.insertBefore(e,null):"bodyEnd"==n?r.lastChild.parentNode.insertBefore(e,null):"bodyStart"==n&&r.firstChild.parentNode.insertBefore(e,null)}},e.prototype.remove=function(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)},new e}));
