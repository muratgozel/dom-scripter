define((function(){"use strict";return function(){var t=0,e=["bodyEnd","bodyStart","headEnd"];function n(t){return t.split("/").reverse()[0].split("?")[0]}function r(e){return e.replace(/[^a-zA-Z0-9]/g,"-").split("-").reverse().join("-")+"-"+t}return{create:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i={timeout:3e3};function a(o){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c={id:null,type:"text/javascript",async:!0,attrs:{},location:e[0],global:null};return"[object Object]"===Object.prototype.toString.call(a)&&Object.keys(c).map((function(t){a.hasOwnProperty(t)&&(c[t]=a[t])})),c.id||(c.id=r(n(o)),t+=1),new Promise((function(t,e){if(document.getElementById(c.id))return t(c.id);var n=setTimeout((function(){return e(new Error("Inject timeout."))}),i.timeout),r=document.createElement("script");function a(){if(clearTimeout(n),!c.global)return t(c.id);var r=0,o=setInterval((function(){return r+=1,window[c.global]?(clearInterval(o),t(c.id)):r>=20?e(new Error("Max call size exceeded. Given up looking for global property.")):void 0}),100)}r.id=c.id,r.type=c.type,r.async=c.async,c.attrs&&Object.keys(c.attrs).map((function(t){r.setAttribute(t,c.attrs[t])})),r.addEventListener?r.addEventListener("load",a,!1):r.readyState?r.onreadystatechange=a:r.onload&&(r.onload=a),r.onerror&&(r.onerror=function(t){return clearTimeout(n),e(t)}),r.src=o,u(r,c.location)}))}function c(o){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c={id:null,type:"text/css",media:"all",attrs:{},location:e[0]};return"[object Object]"===Object.prototype.toString.call(a)&&Object.keys(c).map((function(t){a.hasOwnProperty(t)&&(c[t]=a[t])})),c.id||(c.id=r(n(o)),t+=1),new Promise((function(t,e){if(document.getElementById(c.id))return t(c.id);var n=setTimeout((function(){return e(new Error("Inject timeout."))}),i.timeout),r=document.createElement("link");function a(){return r.media=c.media,clearTimeout(n),t(c.id)}r.id=c.id,r.rel="stylesheet",r.href=o,r.media="only x",c.attrs&&Object.keys(c.attrs).map((function(t){r.setAttribute(t,c.attrs[t])})),r.addEventListener?r.addEventListener("load",a,!1):r.readyState?r.onreadystatechange=a:r.onload&&(r.onload=a),r.onerror&&(r.onerror=function(t){return clearTimeout(n),e(t)}),u(r,c.location)}))}function d(n,r){var o={id:null,type:"application/ld+json",attrs:{},location:e[0]};if("[object Object]"===Object.prototype.toString.call(r)&&Object.keys(o).map((function(t){r.hasOwnProperty(t)&&(o[t]=r[t])})),o.id||(o.id=t,t+=1),document.getElementById(o.id))return o.id;var i=document.createElement("script");return i.id=o.id,i.type=o.type,i.text="string"==typeof n?n:JSON.stringify(n),o.attrs&&Object.keys(o.attrs).map((function(t){i.setAttribute(t,o.attrs[t])})),u(i,o.location),o.id}function l(t){var e=document.getElementById(t);e&&e.parentNode.removeChild(e)}function u(t,e){var n=document.getElementsByTagName("head")[0],r=document.getElementsByTagName("body")[0];"headEnd"==e?n.insertBefore(t,null):"bodyEnd"==e?r.insertBefore(t,null):"bodyStart"==e&&r.insertBefore(t,r.firstChild)}return"[object Object]"===Object.prototype.toString.call(o)&&Object.keys(i).map((function(t){o.hasOwnProperty(t)&&(i[t]=o[t])})),{injectjs:a,injectcss:c,injectjsonld:d,remove:l}}}}()}));
